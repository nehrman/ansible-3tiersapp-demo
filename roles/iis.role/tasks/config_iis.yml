---
# - name: Ensure Default Web Site is not present
#   win_iis_website:
#     name: 'Default Web Site'
#     state: absent

- name: Ensure Windows Powershell DSC Feature is present
  win_feature:
    name: dsc-service
    state: present

- name: Ensure App Web Site directory is present
  win_file:
    path: 'c:\app\app'
    state: directory

# - name: Ensure App web site is present
#   win_iis_website:
#     name: app
#     binding: 80
#     physical_path: 'c:\app\app\'
#     state: present

- name: Ensure Default Web Site is absent
  win_dsc:
    resource_name: xWebSite
    ensure: absent
    name: 'Default Web Site'

- name: Ensure App Web Site is present
  win_dsc:
    resource_name: xWebSite
    ensure: present
    name: 'app'
    physicalpath: 'c:\app\app\'
    port: 80
    state: started

- name: Ensure App Web Site Module is well configured
  win_dsc:
    resource_name: xIISModule
    ensure: present
    name: 'app'
    path: 'c:\python36\python.exe|c:\python36\lib\site-packages\wfastcgi.py'
    requestpath: '*'
    SiteName: app
    ModuleType: fastcgimodule
